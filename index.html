<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf8" />
        <title>Sair</title>
        
        <script src="src/vendor/jquery/jquery-1.11.3.min.js"></script>
        <script src="src/vendor/threejs/three.min.js"></script>
        <script src="src/vendor/threejs/ColladaLoader2.js"></script>     
        <script src="src/vendor/threejs/OrbitControls.js"></script>
        <script src="src/js/config.js"></script>
        <script src="src/js/models.js"></script>
        <script src="src/js/map.js"></script>
        <script src="src/js/objects.js"></script>
        <script src="src/js/engine.js"></script>
        
        <link rel="stylesheet" href="src/css/style.css" />
        <link rel="stylesheet" href="src/css/loader.css" />
        
    </head>
    <body>
        <div id="loader" class="loader">
            <div class="loading">Loading</div>
            <div class="loadinfo" id="loadinfo"></div>
            <div class="loadbar" id="loadbar"></div>
        </div>
        <script>
            var Engine = new Engine();
            Engine.Initialize();
            Engine.Models.Load([
                {name:"plane",path:"vehicles/planes/cessna-152"},
                {name:"fire",path:"vehicles/ground/feuerwehr"},
                {name:"grass",path:"landscape/grass"},
                {name:"street",path:"landscape/grass-street"},
                {name:"runway",path:"landscape/runway"},
				{name:"tanka",path:"vehicles/ground/tank-lkw"},
                {name:"runway-boundary",path:"landscape/runway-boundary"},
            ],function(){
                $('#loader').fadeOut();
                for(x = 0; x < 10; x++)
                    for(y = 0; y < 10; y++)
                        {
                            if(y==5)
                                Engine.Map.Set(x-5, 0, y-5,"runway");
                            else if(y==6)
                                Engine.Map.Set(x-5, 0, y-5,"runway-boundary");
                            else if(y==4)
                                Engine.Map.Set(x-5, 0, y-5,"runway-boundary",0.5);
                            else
                                Engine.Map.Set(x-5,0,y-5,"grass");
                        }
                
				Engine.Objects.Add("tanka",{x:1.5,y:0.5,z:0},"tanka",1, {y:0.75});
                Engine.Objects.Add("fire",{x:0,y:0.5,z:0},"fire",1, {y:0.75});
                Engine.Objects.Add("plane",{x:-5,y:0.5,z:0},"plane",1);
                
            },
            function(mdl, info){
                var total = Math.round(mdl.loaded / mdl.total * 100);
                var percent = Math.round(info.loaded / info.total * 100);
                var loadtext = mdl.path+" ["+percent+"%]";
                $('#loadinfo').html(loadtext);
                $('#loadbar').css({width:total+"%"});
            });
			
			/* afsdfasdf */
			$('html').keypress(function(e){
				switch(e.which) {
					case 119: // w
						Engine.Objects.ChangePosition("fire",{x:-0.2});
						break;
					case 115: // s
						Engine.Objects.ChangePosition("fire",{x:0.2});
						break;
					case 97: // a
						Engine.Objects.ChangePosition("fire",{z:0.2});
						break;
					case 100: // d
						Engine.Objects.ChangePosition("fire",{z:-0.2});
						break;
					case 113: // q
						Engine.Objects.ChangeRotation("fire",{y:0.05});
						break;
					case 101: // e
						Engine.Objects.ChangeRotation("fire",{y:-0.05});
						break;
					default:
						console.log(e.which);
						break;
				}
			});
        </script>
    </body>
</html>